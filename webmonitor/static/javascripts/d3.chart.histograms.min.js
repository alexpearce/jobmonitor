/* d3.chart.histograms 06-05-2014 */
!function(a){"use strict";a.chart("BaseChart",{initialize:function(){var a=this;a.margins={top:10,bottom:40,left:60,right:10,padding:10},a._width=a.base.attr("width")?a.base.attr("width")-(a.margins.right+a.margins.left):200,a._height=a.base.attr("height")?a.base.attr("height")-(a.margins.top+a.margins.bottom):200,a.updateContainerWidth(),a.updateContainerHeight(),a.base.append("g").attr("transform","translate("+this.margins.left+","+this.margins.top+")"),a.areas={},a.layers={}},width:function(a){if(0===arguments.length)return this._width;var b=this._width;return this._width=a,this.updateContainerWidth(),this.trigger("change:width",a,b),this},height:function(a){if(0===arguments.length)return this._height;var b=this._height;return this._height=a,this.updateContainerHeight(),this.trigger("change:height",a,b),this},updateContainerWidth:function(){this.base.attr("width",this._width+this.margins.left+this.margins.right)},updateContainerHeight:function(){this.base.attr("height",this._height+this.margins.top+this.margins.bottom)}})}(window.d3),function(a){"use strict";a.chart("BaseChart").extend("AxesChart",{initialize:function(){var b=this;b.base.classed("AxesChart"),b._xAxisLabel="",b._yAxisLabel="",b._xExponent=0,b._yExponent=0,b.xScale=a.scale.linear().range([0,b.width()]),b.yScale=a.scale.linear().range([b.height(),0]);var c=b.base.select("g");b.areas.xgrid=c.append("g").classed("x grid",!0).attr("transform","translate(0,"+b.height()+")"),b.areas.ygrid=c.append("g").classed("y grid",!0),b.areas.xaxis=c.append("g").classed("x axis",!0).attr("transform","translate(0,"+b.height()+")"),b.areas.yaxis=c.append("g").classed("y axis",!0),b.areas.xlabel=b.base.append("g").classed("x axis-label",!0).attr("transform","translate("+(b.width()+b.margins.left)+","+(b.height()+b.margins.top+b.margins.bottom)+")"),b.areas.xlabel.append("text").attr("text-anchor","end").attr("dy","-0.2em"),b.areas.ylabel=b.base.append("g").classed("y axis-label",!0).attr("transform","rotate(-90) translate("+-b.margins.top+")"),b.areas.ylabel.append("text").attr("text-anchor","end").attr("dy","1em"),b.layers.xaxis=a.svg.axis().ticks(5).scale(b.xScale).orient("bottom"),b.layers.xgrid=a.svg.axis().ticks(5).scale(b.xScale).orient("bottom").tickSize(-b.height(),0,0).tickFormat(""),b.layers.yaxis=a.svg.axis().ticks(5).scale(b.yScale).orient("left"),b.layers.ygrid=a.svg.axis().ticks(5).scale(b.yScale).orient("left").tickSize(-b.width(),0,0).tickFormat(""),b.on("change:width",function(){b.xScale.range([0,b.width()]),b.areas.xlabel.attr("transform","translate("+(b.width()+b.margins.left)+","+(b.height()+b.margins.top+b.margins.bottom)+")"),b.layers.ygrid.tickSize(-b.width(),0,0)}),b.on("change:height",function(){b.yScale.range([b.height(),0]),b.areas.xaxis.attr("transform","translate(0,"+b.height()+")"),b.areas.xgrid.attr("transform","translate(0,"+b.height()+")"),b.areas.xlabel.attr("transform","translate("+(b.width()+b.margins.left)+","+(b.height()+b.margins.top+b.margins.bottom)+")"),b.layers.xgrid.tickSize(-b.height(),0,0)})},drawAxes:function(b){var c=this;if(c.layers.xaxis.tickFormat(null),b===!0){var d=c.base.transition().duration(250);d.select(".x.axis").call(c.layers.xaxis),d.select(".x.grid").call(c.layers.xgrid),d.select(".y.axis").call(c.layers.yaxis),d.select(".y.grid").call(c.layers.ygrid)}else c.areas.xaxis.call(c.layers.xaxis),c.areas.xgrid.call(c.layers.xgrid),c.areas.yaxis.call(c.layers.yaxis),c.areas.ygrid.call(c.layers.ygrid);var e=function(a){return Math.floor(Math.log(Math.abs(a))/Math.LN10)},f=function(b){var c=b,d=a.extent(c),f=e(d[0]),g=e(d[1]),h=a.max([g,f]);return 3*Math.floor(h/3)},g=function(a){var b=e(a[0]-a[1]);return b=0>b?Math.abs(b):0,function(c,d){return a[d].toFixed(b)}},h=c.xScale.ticks(c.layers.xaxis.ticks()[0]),i=c.yScale.ticks(c.layers.yaxis.ticks()[0]);c._xExponent=f(h),c._yExponent=f(i);var j=h.map(function(a){return a/Math.pow(10,c._xExponent)}),k=i.map(function(a){return a/Math.pow(10,c._yExponent)});c.layers.xaxis.tickFormat(g(j)),c.layers.yaxis.tickFormat(g(k)),c.areas.xaxis.call(c.layers.xaxis),c.xAxisLabel(c.xAxisLabel()),c.areas.yaxis.call(c.layers.yaxis),c.yAxisLabel(c.yAxisLabel())},xAxisLabel:function(a){return 0===arguments.length?this._xAxisLabel:(this._xAxisLabel=a,this.areas.xlabel.select("text").text(0!==this._xExponent?this.xAxisLabel()+" ×1e"+this._xExponent:this.xAxisLabel()),this)},yAxisLabel:function(a){return 0===arguments.length?this._yAxisLabel:(this._yAxisLabel=a,this.areas.ylabel.select("text").text(0!==this._yExponent?this.yAxisLabel()+" ×1e"+this._yExponent:this.yAxisLabel()),this)}})}(window.d3),function(a){"use strict";a.chart("AxesChart").extend("Histogram",{initialize:function(){var b=this;b.base.classed("Histogram");var c=b.base.select("g");b.layers.line=c.append("g").classed("line",!0);var d=a.svg.area().interpolate("step-before").x(function(a){return b.xScale(a.dx)}).y1(function(a){return b.yScale(a.y)}).y0(function(){return a.max(b.yScale.range())});b.layer("line",b.layers.line,{dataBind:function(a){return this.selectAll("path").data([a])},insert:function(){return this.append("path").classed("line",!0).attr("fill","none").attr("stroke","rgb(38, 17, 150)")},events:{enter:function(){return this.attr("d",d)},update:function(){return this},"update:transition":function(){return this.attr("d",d)}}})},transform:function(b){var c=this;c.data=b;var d=a.extent(b.map(function(a){return a.x})),e=a.extent(b.map(function(a){return a.dx})),f=.05*Math.abs(d[0]-e[1]),g=a.extent(b,function(a){return a.y});c.xScale.domain([d[0]-f,e[1]+f]);var h=g[0]>0?0:g[0];return c.yScale.domain([h,1.05*g[1]]),c.drawAxes(),b}})}(window.d3),function(a){"use strict";a.chart("Histogram").extend("HistogramZoom",{initialize:function(){var b=this,c=b.base.append("defs").append("clipPath").attr("id","chartArea").append("rect").attr("width",b.width()).attr("height",b.height());b.layers.line.attr("clip-path","url(#chartArea)");var d=function(a){b.xScale.domain(a),b.drawAxes(!0),b.layers.line.draw(b.data)},e=a.svg.brush().x(b.xScale).on("brushend",function(){if(e.empty()!==!0){var a=b.base.select(".clear-button");if(a.empty()===!0){b.xScale.originalDomain=b.xScale.domain();var c=b.base.append("g").classed("clear-button",!0).attr("transform","translate("+(b.width()-b.margins.left)+","+b.margins.top+")");c.append("rect").attr("width",100).attr("height",40).attr("rx",2).attr("ry",2),c.append("text").attr("x",10).attr("y",25).text("Clear zoom"),c.on("click",function(){b.base.select(".brush").call(e.clear()),d(b.xScale.originalDomain),c.remove()})}d(e.extent()),b.base.select(".brush").call(e.clear())}});b.areas.brush=b.base.append("g").classed("brush",!0).attr("transform","translate("+b.margins.left+", "+b.margins.top+")"),b.areas.brush.call(e).selectAll("rect").attr("height",b.height()),b.on("change:height",function(){c.attr("height",b.height()),b.areas.brush.call(e).selectAll("rect").attr("height",b.height())}),b.on("change:width",function(){c.attr("width",b.width())})}})}(window.d3);